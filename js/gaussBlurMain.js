function gaussBlur(r){var t,a,o,f,s,e,h,n,u,g,i=r.data,M=r.width,d=r.height,l=[],c=0,p=10;for(e=1/(5*Math.sqrt(2*Math.PI)),s=-.02,h=0,t=-p;t<=p;t++,h++)f=e*Math.exp(s*t*t),c+=l[h]=f;for(h=0,g=l.length;h<g;h++)l[h]/=c;for(a=0;a<d;a++)for(t=0;t<M;t++){for(o=f=s=e=0,c=0,n=-p;n<=p;n++)0<=(u=t+n)&&u<M&&(o+=i[h=4*(a*M+u)]*l[n+p],f+=i[h+1]*l[n+p],s+=i[h+2]*l[n+p],c+=l[n+p]);i[h=4*(a*M+t)]=o/c,i[h+1]=f/c,i[h+2]=s/c}for(t=0;t<M;t++)for(a=0;a<d;a++){for(o=f=s=e=0,c=0,n=-p;n<=p;n++)0<=(u=a+n)&&u<d&&(o+=i[h=4*(u*M+t)]*l[n+p],f+=i[h+1]*l[n+p],s+=i[h+2]*l[n+p],c+=l[n+p]);i[h=4*(a*M+t)]=o/c,i[h+1]=f/c,i[h+2]=s/c}return r}onmessage=function(r){postMessage(gaussBlur(r.data))};